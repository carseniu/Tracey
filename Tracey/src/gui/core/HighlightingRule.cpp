#include "src/gui/core/HighlightingRule.h"


//===================================================================================================================================================================================================//
// PUBLIC
//===================================================================================================================================================================================================//

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
HighlightingRule::HighlightingRule(const QString& id, const QString& item, const QString& foregroundColor, const QString& backgroundColor,
  bool matchCase, bool wholeWord, bool enabled, int sort)
{
  this->id = id;
  this->item = item;
  this->foregroundColor = foregroundColor;
  this->backgroundColor = backgroundColor;
  this->wholeLine = wholeLine;
  this->matchCase = matchCase;
  this->wholeWord = wholeWord;
  this->enabled = enabled;
  this->sort = sort;

  setWholeWord(wholeWord);

  format.setForeground(QColor(foregroundColor));
  format.setBackground(QColor(backgroundColor));
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
QString HighlightingRule::getBackgroundColor() const
{
  return backgroundColor;
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
QString HighlightingRule::getId() const
{
  return id;
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
QString HighlightingRule::getItem() const
{
  return item;
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
QString HighlightingRule::getForegroundColor() const
{
  return foregroundColor;
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
QTextCharFormat HighlightingRule::getFormat() const
{
  return format;
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
QRegularExpression HighlightingRule::getRegularExpression() const
{
  QString pattern = QRegularExpression::escape(item);

  if (wholeWord)
  {
    pattern.prepend("\\b");
    pattern.append("\\b");
  }

  if (matchCase)
  {
    return QRegularExpression(pattern);
  }
  else{
    return QRegularExpression(pattern, QRegularExpression::CaseInsensitiveOption);
  }
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
int HighlightingRule::getSort() const
{ 
  return sort;
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
bool HighlightingRule::isEnabled() const
{
  return enabled;
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
bool HighlightingRule::isMatchCase() const
{
  return matchCase;
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
bool HighlightingRule::isWholeWord() const
{
  return wholeWord;
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
void HighlightingRule::setBackgroundColor(const QString& color)
{
  this->backgroundColor = color;

  format.setBackground(QColor(color));
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
void HighlightingRule::setEnabled(bool enabled)
{
  this->enabled = enabled;
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
void HighlightingRule::setForegroundColor(const QString& color)
{
  this->foregroundColor = color;

  format.setForeground(QColor(color));
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
void HighlightingRule::setFormat(const QTextCharFormat& format)
{
  this->format = format;
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
void HighlightingRule::setItem(const QString& item)
{
  this->item = item;
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
void HighlightingRule::setMatchCase(bool matchCase)
{
  this->matchCase = matchCase;
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
void HighlightingRule::setSort(int sort)
{
  this->sort = sort;
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
void HighlightingRule::setWholeWord(bool wholeWord)
{
  this->wholeWord = wholeWord;
}