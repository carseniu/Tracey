#include "src/gui/widgets/list/List.h"

#include "src/gui/widgets/list/ItemDelegateList.h"


//===================================================================================================================================================================================================//
// PUBLIC
//===================================================================================================================================================================================================//

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
List::List(QWidget* parent) :
  QListWidget(parent),
  drag(false),
  startDragPosition(-1)
{
  ItemDelegateList* itemDelegateList = new ItemDelegateList(this);

  setItemDelegate(itemDelegateList);
}


//===================================================================================================================================================================================================//
// PROTECTED
//===================================================================================================================================================================================================//

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
void List::dragMoveEvent(QDragMoveEvent *event) 
{
  if (!drag)
  {
    startDragPosition = currentRow();
    drag = true;
  }

  QListWidget::dragMoveEvent(event);
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
void List::dropEvent(QDropEvent* event)
{
  QListWidget::dropEvent(event);

  emit itemRowChanged(startDragPosition, currentRow());

  drag = false;
  startDragPosition = -1;
}