#include "Margin.h"

#include "Viewport.h"


//===================================================================================================================================================================================================//
// PUBLIC
//===================================================================================================================================================================================================//

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
Margin::Margin(Viewport* viewport) :
  QFrame(viewport),
  viewport(viewport)
{
  setObjectName("TraceViewerMargin");
  setCursor(Qt::ArrowCursor);
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
void Margin::addIndex(int index, const QRect& rect)
{
  indexMap[index] = rect;
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
void Margin::clearIndexMap()
{
  indexMap.clear();
}


//===================================================================================================================================================================================================//
// PROTECTED
//===================================================================================================================================================================================================//

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
void Margin::mousePressEvent(QMouseEvent* event)
{
  for (int index : indexMap.keys())
  {
    if (indexMap[index].contains(event->pos()))
    {
      emit markToggled(index);
      break;
    }
  }
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
void Margin::paintEvent(QPaintEvent* event)
{
  viewport->paintMargin(event);
}